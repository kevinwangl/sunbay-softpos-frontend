import { Device, User, HealthCheck, ThreatEvent, Transaction, AuditLog } from '@/types';

export const mockUser: User = {
  id: '1',
  username: 'admin',
  role: 'admin',
  email: 'admin@sunbay.com',
};

// 生成更多设备数据
export const mockDevices: Device[] = [
  {
    id: 'device-001',
    imei: '123456789012345',
    model: 'Samsung Galaxy S21',
    osVersion: 'Android 13',
    teeType: 'TrustZone',
    status: 'ACTIVE',
    merchantId: 'merchant-001',
    merchantName: '星巴克咖啡（国贸店）',
    securityScore: 95,
    registeredAt: '2024-01-15T10:30:00Z',
    lastActiveAt: '2024-11-17T10:20:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00001',
      ipekInjectedAt: '2024-01-15T10:35:00Z',
      remainingCount: 850000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-002',
    imei: '987654321098765',
    model: 'Xiaomi 13 Pro',
    osVersion: 'Android 12',
    teeType: 'QTEE',
    status: 'ACTIVE',
    merchantId: 'merchant-002',
    merchantName: '麦当劳（望京店）',
    securityScore: 88,
    registeredAt: '2024-02-20T14:15:00Z',
    lastActiveAt: '2024-11-17T09:45:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00002',
      ipekInjectedAt: '2024-02-20T14:20:00Z',
      remainingCount: 950000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-003',
    imei: '456789012345678',
    model: 'Huawei P50',
    osVersion: 'HarmonyOS 3',
    teeType: 'TrustZone',
    status: 'PENDING',
    merchantId: 'merchant-003',
    merchantName: '全家便利店（三里屯店）',
    securityScore: 78,
    registeredAt: '2024-11-16T16:00:00Z',
    lastActiveAt: '2024-11-16T16:00:00Z',
    keyInfo: {
      currentKsn: '',
      ipekInjectedAt: '',
      remainingCount: 0,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-004',
    imei: '234567890123456',
    model: 'iPhone 14 Pro',
    osVersion: 'iOS 17',
    teeType: 'TrustZone',
    status: 'ACTIVE',
    merchantId: 'merchant-004',
    merchantName: '海底捞火锅（朝阳大悦城）',
    securityScore: 92,
    registeredAt: '2024-03-10T09:20:00Z',
    lastActiveAt: '2024-11-17T10:15:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00004',
      ipekInjectedAt: '2024-03-10T09:25:00Z',
      remainingCount: 920000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-005',
    imei: '345678901234567',
    model: 'OPPO Find X6',
    osVersion: 'Android 13',
    teeType: 'QTEE',
    status: 'ACTIVE',
    merchantId: 'merchant-005',
    merchantName: '屈臣氏（西单店）',
    securityScore: 55,
    registeredAt: '2024-04-05T11:30:00Z',
    lastActiveAt: '2024-11-17T08:30:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00005',
      ipekInjectedAt: '2024-04-05T11:35:00Z',
      remainingCount: 880000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-006',
    imei: '567890123456789',
    model: 'Vivo X90 Pro',
    osVersion: 'Android 13',
    teeType: 'TrustZone',
    status: 'SUSPENDED',
    merchantId: 'merchant-006',
    merchantName: '肯德基（中关村店）',
    securityScore: 42,
    registeredAt: '2024-05-12T13:45:00Z',
    lastActiveAt: '2024-11-15T16:20:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00006',
      ipekInjectedAt: '2024-05-12T13:50:00Z',
      remainingCount: 750000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-007',
    imei: '678901234567890',
    model: 'Samsung Galaxy S23 Ultra',
    osVersion: 'Android 14',
    teeType: 'TrustZone',
    status: 'ACTIVE',
    merchantId: 'merchant-007',
    merchantName: '优衣库（王府井店）',
    securityScore: 90,
    registeredAt: '2024-06-18T15:00:00Z',
    lastActiveAt: '2024-11-17T09:50:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00007',
      ipekInjectedAt: '2024-06-18T15:05:00Z',
      remainingCount: 890000,
      totalCount: 1000000,
    },
  },
  {
    id: 'device-008',
    imei: '789012345678901',
    model: 'Xiaomi 14',
    osVersion: 'Android 14',
    teeType: 'QTEE',
    status: 'ACTIVE',
    merchantId: 'merchant-008',
    merchantName: '盒马鲜生（三里屯店）',
    securityScore: 87,
    registeredAt: '2024-07-22T10:15:00Z',
    lastActiveAt: '2024-11-17T10:05:00Z',
    keyInfo: {
      currentKsn: 'FFFF9876543210E00008',
      ipekInjectedAt: '2024-07-22T10:20:00Z',
      remainingCount: 910000,
      totalCount: 1000000,
    },
  },
];

// 健康检查数据
export const mockHealthChecks: HealthCheck[] = [
  {
    id: 'hc-001',
    deviceId: 'device-001',
    timestamp: '2024-11-17T10:00:00Z',
    securityScore: 95,
    checks: {
      root: { passed: true, details: '未检测到Root' },
      hook: { passed: true, details: '未检测到Hook框架' },
      debug: { passed: true, details: '未处于调试模式' },
      tee: { passed: true, details: 'TEE完整性验证通过' },
    },
    recommendedAction: 'PROCEED',
    threats: [],
  },
  {
    id: 'hc-002',
    deviceId: 'device-005',
    timestamp: '2024-11-17T08:30:00Z',
    securityScore: 55,
    checks: {
      root: { passed: false, details: '检测到Root权限' },
      hook: { passed: true, details: '未检测到Hook框架' },
      debug: { passed: true, details: '未处于调试模式' },
      tee: { passed: true, details: 'TEE完整性验证通过' },
    },
    recommendedAction: 'WARN',
    threats: ['Root'],
  },
];

// 威胁事件数据
export const mockThreats: ThreatEvent[] = [
  {
    id: 'threat-001',
    deviceId: 'device-005',
    type: 'Root',
    severity: 'HIGH',
    status: 'PENDING',
    detectedAt: '2024-11-17T08:30:00Z',
    description: '检测到设备已获取Root权限，存在安全风险',
    detectionData: {
      rootMethod: 'Magisk',
      suBinary: '/system/xbin/su',
    },
  },
  {
    id: 'threat-002',
    deviceId: 'device-006',
    type: 'Hook',
    severity: 'HIGH',
    status: 'RESOLVED',
    detectedAt: '2024-11-15T16:20:00Z',
    description: '检测到Xposed框架，可能存在代码注入风险',
    detectionData: {
      framework: 'Xposed',
      modules: ['XPrivacyLua'],
    },
    resolution: {
      resolvedBy: 'admin',
      resolvedAt: '2024-11-16T09:00:00Z',
      notes: '已通知商户卸载Xposed框架，设备已暂停使用',
    },
  },
];

// 交易数据
export const mockTransactions: Transaction[] = [
  {
    id: 'txn-001',
    deviceId: 'device-001',
    amount: 4580,
    currency: 'CNY',
    type: 'SALE',
    status: 'SUCCESS',
    authCode: 'AUTH123456',
    timestamp: '2024-11-17T10:15:00Z',
    healthCheckId: 'hc-001',
    securityScore: 95,
  },
  {
    id: 'txn-002',
    deviceId: 'device-002',
    amount: 12800,
    currency: 'CNY',
    type: 'SALE',
    status: 'SUCCESS',
    authCode: 'AUTH123457',
    timestamp: '2024-11-17T09:45:00Z',
    healthCheckId: 'hc-003',
    securityScore: 88,
  },
  {
    id: 'txn-003',
    deviceId: 'device-005',
    amount: 8900,
    currency: 'CNY',
    type: 'SALE',
    status: 'FAILED',
    timestamp: '2024-11-17T08:30:00Z',
    healthCheckId: 'hc-002',
    securityScore: 55,
    errorCode: 'SEC_001',
    errorMessage: '设备安全评分过低，交易被拒绝',
  },
];

// 审计日志数据
export const mockAuditLogs: AuditLog[] = [
  {
    id: 'log-001',
    userId: '1',
    username: 'admin',
    action: '设备审批',
    resource: 'device',
    resourceId: 'device-003',
    ipAddress: '192.168.1.100',
    timestamp: '2024-11-17T09:00:00Z',
    details: { action: 'approve', deviceId: 'device-003' },
    result: 'SUCCESS',
  },
  {
    id: 'log-002',
    userId: '1',
    username: 'admin',
    action: '设备暂停',
    resource: 'device',
    resourceId: 'device-006',
    ipAddress: '192.168.1.100',
    timestamp: '2024-11-16T14:30:00Z',
    details: { action: 'suspend', reason: '安全评分过低' },
    result: 'SUCCESS',
  },
];

export const generateMockToken = () => {
  return 'mock-jwt-token-' + Math.random().toString(36).substring(7);
};

// SDK版本数据
import type { SDKVersion, VersionDistribution, VersionUpdateRecord, VersionPushTask } from '@/types/version';

export const mockSDKVersions: SDKVersion[] = [
  {
    id: 'version-001',
    version: '2.1.0',
    updateType: 'OPTIONAL',
    status: 'ACTIVE',
    downloadUrl: 'https://cdn.sunbay.com/sdk/tapro-softpos-2.1.0.apk',
    fileSize: 15728640, // 15MB
    md5: 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6',
    releaseNotes: '新增支持银联云闪付，优化NFC读卡性能，修复已知问题',
    releasedAt: '2024-11-01T10:00:00Z',
    releasedBy: 'admin',
    minApiVersion: 'v2',
    maxApiVersion: 'v3',
    deviceCount: 3,
    adoptionRate: 37.5,
  },
  {
    id: 'version-002',
    version: '2.0.5',
    updateType: 'FORCE',
    status: 'ACTIVE',
    downloadUrl: 'https://cdn.sunbay.com/sdk/tapro-softpos-2.0.5.apk',
    fileSize: 14680064, // 14MB
    md5: 'b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7',
    releaseNotes: '紧急安全更新：修复密钥泄露漏洞，所有设备必须升级',
    releasedAt: '2024-10-15T14:30:00Z',
    releasedBy: 'admin',
    minApiVersion: 'v2',
    maxApiVersion: 'v3',
    deviceCount: 4,
    adoptionRate: 50.0,
  },
  {
    id: 'version-003',
    version: '1.9.8',
    updateType: 'OPTIONAL',
    status: 'MAINTENANCE',
    downloadUrl: 'https://cdn.sunbay.com/sdk/tapro-softpos-1.9.8.apk',
    fileSize: 13631488, // 13MB
    md5: 'c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8',
    releaseNotes: '维护版本，仅提供关键bug修复',
    releasedAt: '2024-08-20T09:00:00Z',
    releasedBy: 'admin',
    minApiVersion: 'v1',
    maxApiVersion: 'v2',
    deviceCount: 1,
    adoptionRate: 12.5,
  },
  {
    id: 'version-004',
    version: '1.8.0',
    updateType: 'OPTIONAL',
    status: 'DEPRECATED',
    downloadUrl: 'https://cdn.sunbay.com/sdk/tapro-softpos-1.8.0.apk',
    fileSize: 12582912, // 12MB
    md5: 'd4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9',
    releaseNotes: '旧版本，已废弃，请尽快升级',
    releasedAt: '2024-03-15T10:00:00Z',
    releasedBy: 'admin',
    minApiVersion: 'v1',
    maxApiVersion: 'v1',
    deviceCount: 0,
    adoptionRate: 0,
  },
];

// 版本分发策略数据
export const mockDistributions: VersionDistribution[] = [
  {
    id: 'dist-001',
    versionId: 'version-001',
    strategyType: 'GRAY',
    percentage: 50,
    startTime: '2024-11-01T10:00:00Z',
    status: 'ACTIVE',
    createdBy: 'admin',
    createdAt: '2024-11-01T09:00:00Z',
  },
  {
    id: 'dist-002',
    versionId: 'version-002',
    strategyType: 'FULL',
    startTime: '2024-10-15T14:30:00Z',
    status: 'COMPLETED',
    createdBy: 'admin',
    createdAt: '2024-10-15T14:00:00Z',
  },
];

// 版本更新记录数据
export const mockVersionUpdates: VersionUpdateRecord[] = [
  {
    id: 'update-001',
    deviceId: 'device-001',
    fromVersion: '2.0.5',
    toVersion: '2.1.0',
    status: 'SUCCESS',
    startedAt: '2024-11-02T10:00:00Z',
    completedAt: '2024-11-02T10:05:00Z',
    notifiedAt: '2024-11-02T09:00:00Z',
  },
  {
    id: 'update-002',
    deviceId: 'device-002',
    fromVersion: '2.0.5',
    toVersion: '2.1.0',
    status: 'SUCCESS',
    startedAt: '2024-11-03T14:00:00Z',
    completedAt: '2024-11-03T14:06:00Z',
    notifiedAt: '2024-11-03T09:00:00Z',
  },
  {
    id: 'update-003',
    deviceId: 'device-004',
    fromVersion: '2.0.5',
    toVersion: '2.1.0',
    status: 'SUCCESS',
    startedAt: '2024-11-04T11:00:00Z',
    completedAt: '2024-11-04T11:07:00Z',
    notifiedAt: '2024-11-04T09:00:00Z',
  },
  {
    id: 'update-004',
    deviceId: 'device-005',
    fromVersion: '1.9.8',
    toVersion: '2.0.5',
    status: 'FAILED',
    failureReason: '下载失败：网络超时',
    startedAt: '2024-10-20T15:00:00Z',
    notifiedAt: '2024-10-20T09:00:00Z',
  },
  {
    id: 'update-005',
    deviceId: 'device-007',
    fromVersion: '2.0.5',
    toVersion: '2.1.0',
    status: 'DOWNLOADING',
    startedAt: '2024-11-17T10:00:00Z',
    notifiedAt: '2024-11-17T09:00:00Z',
  },
  {
    id: 'update-006',
    deviceId: 'device-008',
    fromVersion: '2.0.5',
    toVersion: '2.1.0',
    status: 'PENDING',
    notifiedAt: '2024-11-17T09:00:00Z',
    startedAt: '2024-11-17T10:00:00Z',
  },
];

// 版本推送任务数据
export const mockPushTasks: VersionPushTask[] = [
  {
    id: 'push-001',
    versionId: 'version-001',
    targetType: 'ALL',
    totalCount: 8,
    successCount: 3,
    failedCount: 0,
    pendingCount: 5,
    status: 'RUNNING',
    scheduledAt: '2024-11-17T09:00:00Z',
    startedAt: '2024-11-17T09:00:00Z',
    createdBy: 'admin',
    createdAt: '2024-11-16T18:00:00Z',
  },
  {
    id: 'push-002',
    versionId: 'version-002',
    targetType: 'ALL',
    totalCount: 8,
    successCount: 7,
    failedCount: 1,
    pendingCount: 0,
    status: 'COMPLETED',
    scheduledAt: '2024-10-15T14:30:00Z',
    startedAt: '2024-10-15T14:30:00Z',
    completedAt: '2024-10-20T16:00:00Z',
    createdBy: 'admin',
    createdAt: '2024-10-15T14:00:00Z',
  },
  {
    id: 'push-003',
    versionId: 'version-001',
    targetType: 'MERCHANT',
    targetIds: ['merchant-001', 'merchant-002'],
    totalCount: 2,
    successCount: 2,
    failedCount: 0,
    pendingCount: 0,
    status: 'COMPLETED',
    scheduledAt: '2024-11-01T10:00:00Z',
    startedAt: '2024-11-01T10:00:00Z',
    completedAt: '2024-11-02T12:00:00Z',
    createdBy: 'admin',
    createdAt: '2024-11-01T09:00:00Z',
  },
];

// 为设备添加SDK版本信息
export const deviceSDKVersions: Record<string, string> = {
  'device-001': '2.1.0',
  'device-002': '2.1.0',
  'device-003': '2.0.5',
  'device-004': '2.1.0',
  'device-005': '1.9.8',
  'device-006': '2.0.5',
  'device-007': '2.0.5',
  'device-008': '2.0.5',
};

// 设备密钥状态数据
export const deviceKeyStatus: Record<string, any> = {
  'device-001': {
    deviceId: 'device-001',
    currentKSN: 'FFFF9876543210E00001',
    remainingCount: 850000,
    status: 'ACTIVE',
    lastUpdated: '2024-01-15T10:35:00Z',
    nextUpdateRequired: '2024-07-15T10:35:00Z',
  },
  'device-002': {
    deviceId: 'device-002',
    currentKSN: 'FFFF9876543210E00002',
    remainingCount: 950000,
    status: 'ACTIVE',
    lastUpdated: '2024-02-20T14:20:00Z',
    nextUpdateRequired: '2024-08-20T14:20:00Z',
  },
  'device-003': {
    deviceId: 'device-003',
    currentKSN: '',
    remainingCount: 0,
    status: 'EXPIRED',
    lastUpdated: '',
  },
  'device-004': {
    deviceId: 'device-004',
    currentKSN: 'FFFF9876543210E00004',
    remainingCount: 920000,
    status: 'ACTIVE',
    lastUpdated: '2024-03-10T09:25:00Z',
    nextUpdateRequired: '2024-09-10T09:25:00Z',
  },
  'device-005': {
    deviceId: 'device-005',
    currentKSN: 'FFFF9876543210E00005',
    remainingCount: 50000,
    status: 'NEAR_EXPIRY',
    lastUpdated: '2024-04-05T11:35:00Z',
    nextUpdateRequired: '2024-10-05T11:35:00Z',
  },
  'device-006': {
    deviceId: 'device-006',
    currentKSN: 'FFFF9876543210E00006',
    remainingCount: 750000,
    status: 'ACTIVE',
    lastUpdated: '2024-05-12T13:50:00Z',
    nextUpdateRequired: '2024-11-12T13:50:00Z',
  },
  'device-007': {
    deviceId: 'device-007',
    currentKSN: 'FFFF9876543210E00007',
    remainingCount: 890000,
    status: 'ACTIVE',
    lastUpdated: '2024-06-18T15:05:00Z',
    nextUpdateRequired: '2024-12-18T15:05:00Z',
  },
  'device-008': {
    deviceId: 'device-008',
    currentKSN: 'FFFF9876543210E00008',
    remainingCount: 80000,
    status: 'NEAR_EXPIRY',
    lastUpdated: '2024-07-22T10:20:00Z',
    nextUpdateRequired: '2025-01-22T10:20:00Z',
  },
};
